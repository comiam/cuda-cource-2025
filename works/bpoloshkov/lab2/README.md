# Lab 2: Matrix Multiplication

## Описание

Программа выполняет перемножение квадратных матриц на GPU с использованием CUDA. Реализованы две версии: базовая (naive) и оптимизированная с использованием shared memory.

## Требования

- CUDA Toolkit 11.0+
- GPU с поддержкой CUDA
- Linux / macOS с nvcc
- Make

## Компиляция

```bash
make
```

## Запуск

```bash
./matmul [N]
```

Параметр `N` — размер матрицы от 32 до 4096 (по умолчанию 1024).

### Примеры

```bash
./matmul 256
./matmul 1024
./matmul 2048
```

## Результаты

```
Matrix size: 512x512

CPU time:              0.2156 sec
GPU time (naive):      0.0013 sec
GPU time (shared mem): 0.0008 sec

Verification (naive):  PASSED
Verification (shared): PASSED

Speedup (naive):       170.7x
Speedup (shared):      280.6x
```

## Алгоритм

### Базовая версия (naive)

Каждый поток вычисляет один элемент результирующей матрицы C:

```
C[i][j] = SUM (A[i][k] * B[k][j])  для k = 0..N-1
```

Недостаток: многократное чтение из глобальной памяти GPU, что медленно.

### Оптимизированная версия (shared memory)

Матрицы разбиваются на тайлы размером BLOCK_SIZE × BLOCK_SIZE. Каждый блок потоков:

1. Загружает тайл A и тайл B в shared memory
2. Синхронизирует потоки (`__syncthreads`)
3. Вычисляет частичную сумму из shared memory
4. Повторяет для всех тайлов

Преимущество: данные читаются из быстрой shared memory вместо медленной глобальной.

## Используемые функции

| Функция | Описание |
|---------|----------|
| `cudaMalloc` | Выделяет память на GPU |
| `cudaMemcpy` | Копирует данные между CPU и GPU |
| `cudaEventCreate` | Создаёт событие для измерения времени |
| `cudaEventRecord` | Записывает событие в поток |
| `cudaEventSynchronize` | Ожидает завершения события |
| `cudaEventElapsedTime` | Вычисляет время между событиями |
| `__syncthreads` | Синхронизирует потоки внутри блока |
| `__shared__` | Объявляет переменную в shared memory |

## Особенности реализации

- Размер блока: 16×16 потоков
- CPU бенчмарк выполняется только для N ≤ 512 (иначе слишком долго)
- Верификация: сравнение результатов CPU и GPU с допуском 1e-3
- Время GPU измеряется через CUDA Events для точности

