# Lab 3: Sobel Operator - Оператор Собеля

## Описание
Реализация фильтра Собеля для обнаружения границ на изображении с использованием CUDA. Программа загружает изображение, преобразует его в оттенки серого, применяет оператор Собеля на GPU и сохраняет результат.

## Запуск

Программа принимает два необязательных аргумента: путь к входному изображению и путь для сохранения результата.

```bash
./sobel_filter [input_image] [output_image]
```

Если аргументы не указаны, используются значения по умолчанию:
- Вход: `images/test_input.jpg`
- Выход: `images/out_sobel.jpg`

### Пример запуска:
```bash
./sobel_filter images/my_photo.jpg images/result.jpg
```

## Реализация
В основе реализации лежит CUDA kernel `sobel_kernel_tiled`, который выполняет свертку изображения с матрицами оператора Собеля (Gx и Gy).

### Оптимизации:
1.  **Tiling (Тайлинг):** Изображение разбивается на блоки (тайлы) размером 16x16 (плюс границы).
2.  **Shared Memory:** Каждый блок потоков загружает свой тайл в быструю разделяемую память (shared memory). Это позволяет избежать повторных чтений одних и тех же пикселей из глобальной памяти (каждый пиксель используется соседними потоками при вычислении свертки).
3.  **Обработка границ:** Корректно обрабатываются края изображения (padding нулями).
4. Вместо классического корня используется модуль при итоговом расчете фильтра. 

## Результаты работы

### Входное изображение
![Input](images/test_input.jpg)

### Результат (Выделение границ)
![Output](images/out_sobel.jpg)

### Пример лога работы
```text
Loaded: 1920x1080 (3 channels)
CUDA kernel completed successfully
Saved result to: images/out_sobel.jpg
```
