## Лабораторная 2

### Описание задачи

Реализовать перемножение матриц на CUDA.

### Требования

- Реализовать перемножение прямоугольных матриц (NxM × MxK)
- Поддерживать матрицы разных размеров (от 32x32 до 4096x4096)
- Сравнить производительность с CPU вычислениями
- Базовая реализация без оптимизаций
- Реализовать оптимизированную версию с использованием shared memory
- Коалесцированный доступ к памяти
- Корректные результаты на тестовых данных

### Компиляция

```make```

### Запуск

```./main N M K```

N, M, K - целые числа, размеры матриц.

### Описание реализации

В базовой версии ядра каждый поток GPU вычисляет один элемент результирующей матрицы C. Используется прямое перемножение строки матрицы A на столбец матрицы B. Это неоптимально из-за многократного чтения из глобальной памяти.

В улучшенной версии используются оптимизации:

- Матрицы разбиваются на квадратные блоки размером TILE_SIZExTILE_SIZE. Каждый блок потоков GPU обрабатывает один тайл результирующей матрицы C.

- Каждый блок загружает тайлы матриц A и B из медленной глобальной памяти в быструю shared memory. Данные в ней используются многократно всеми потоками блока.

- Соседние потоки загружают соседние элементы в глобальной памяти, а GPU объединяет эти операции в одну широкую транзакцию (коалесцированный доступ)

После загрузки тайлов в shared memory, а также после умножения загруженных тайлов происходит синхронизация потоков. В итоге конечный результат записывается в глобальную память.

### Вывод программы

Команда: ```./main 1024 1024 1024```

```
First matrix size: 1024x1024
Second matrix size: 1024x1024
Result matrix size: 1024x1024

CPU: 4019.82 ms
Naive kernel: 38.2733 ms
Shared kernel: 30.4827 ms

Naive speedup: x105.029
Shared speedup: x131.872
Naive kernel is correct
Shared kernel is correct
```

Команда: ```./main 128 256 4096```

```
First matrix size: 128x256
Second matrix size: 256x4096
Result matrix size: 128x4096

CPU: 326.845 ms
Naive kernel: 4.48992 ms
Shared kernel: 3.90531 ms

Naive speedup: x72.7953
Shared speedup: x83.6925
Naive kernel is correct
Shared kernel is correct
```

### Результаты

Программа реализует перемножение матриц разных размеров, квадратных и прямоугольных. Имеется реализация на CPU, базовая реализация на GPU и улучшенная реализация на GPU. Вычисления производятся корректно.
