# Lab 3: Sobel Operator - Оператор Собеля

## Описание

Реализация фильтра Собеля для обнаружения границ в изображении с использованием CUDA. Программа загружает изображение в формате PNG или PGM, применяет оператор Собеля на GPU с использованием shared memory для оптимизации, и сохраняет результат обратно в файл.

## Требования

- CUDA Toolkit 11.0 или выше
- GPU с compute capability 7.5+ (можно изменить в Makefile)
- Компилятор с поддержкой C++14
- Make

## Компиляция
- Для работы с .png нужно скачать lodepng.h и lodepng.cpp [отсюда](https://github.com/lvandeve/lodepng) и разместить их в папке src
```bash
make
```

## Запуск

```bash
./sobel <входное_изображение> <выходное_изображение>

# Примеры:
./sobel image/cat.png image/cat_sobel.png
```

## Результаты

Программа выводит время выполнения оператора Собеля на GPU и сохраняет результат в указанный файл.

### Пример вывода:
```
Sobel time: 0.670912 ms (size: 7045x4552)
Code output in: image/2k_sobel.png
```


## Оператор Собеля

Оператор Собеля вычисляет градиент изображения в двух направлениях:

```
Gx = [-1  0  1]    Gy = [-1 -2 -1]
     [-2  0  2]         [ 0  0  0]
     [-1  0  1]         [ 1  2  1]

Magnitude = √(Gx² + Gy²)
```

Результат ограничивается диапазоном [0, 255] для корректного отображения.

## Результаты

```
Sobel time: 0.176832 ms (size: 2560x1440)
Code output in: image/2k_sobel.png
```

```
Sobel time: 0.130848 ms (size: 720x1280)
Code output in: image/cool_sobel.png
```

```
PS D:\CUDA\cuda-cource-2025\works\cherednikov-eo\lab_3> ./sobel image/bird.pgm image/bird_sobel.pgm
Sobel time: 0.109024 ms (size: 321x481)
Code output in: image/bird_sobel.pgm
```


## Замечания

- Граничные пиксели (первая и последняя строка/столбец) устанавливаются в 0, так как для них невозможно вычислить полный оператор Собеля
- Программа автоматически определяет формат изображения по расширению файла
- PNG изображения автоматически преобразуются в grayscale при загрузке
