# Lab 2: Matrix Multiplication

## Описание

Программа реализует умножение матриц на CPU и GPU с использованием CUDA. Сравниваются три версии:
- **CPU версия** - наивная последовательная реализация
- **GPU naive** - базовая параллельная реализация на GPU
- **GPU optimized** - оптимизированная версия с использованием shared memory и tiling техники

Программа автоматически сравнивает результаты и выводит время выполнения для каждой версии.

## Требования

- CUDA Toolkit 11.0 или выше
- GPU с compute capability 7.0+
- Компилятор с поддержкой C++14
- Make

## Компиляция

```bash
make
```

Альтернативно, прямая компиляция:
```bash
nvcc -O3 -arch=sm_75 -use_fast_math -std=c++14 -o lab_2 main.cu
```

Очистка скомпилированных файлов:
```bash
make clean
```

## Запуск

```bash
./lab_2
# или на Windows:
lab_2.exe
```

Программа не принимает аргументы командной строки. Размеры матриц заданы в коде:
- Матрица A: m×n (по умолчанию 48×32)
- Матрица B: n×k (по умолчанию 32×48)
- Результирующая матрица C: m×k (48×48)

## Результаты

Программа выводит время выполнения для каждой версии и проверяет корректность результатов:

### Пример вывода для матриц 48×32 и 32×48:

```
GPU naive      time: 0.098 ms
GPU optimized  time: 0.016 ms
CPU time: 0.088 ms
Results are correct. GPU speedup = 5.977
```

### Пример вывода для матриц 2048×2048:

```
GPU naive      time: 20.129 ms
GPU optimized  time: 13.109 ms
CPU time: 10413.236 ms
Results are correct. GPU speedup = 0.651
```

### Пример вывода для матриц 4096×4096:

```
GPU naive      time: 153.781 ms
GPU optimized  time: 90.911 ms
CPU time: 86673.565 ms
Results are correct. GPU speedup = 0.591
```


## Замечания

- Размеры матриц захардкожены в коде (переменные `m`, `n`, `k` в функции `main`)
- Для изменения размеров необходимо редактировать код и перекомпилировать
- Размер тайла можно изменить через макрос `TILE` (по умолчанию 16)
- Оптимизированная версия показывает значительное ускорение на больших матрицах
- На маленьких матрицах overhead от использования shared memory может снижать производительность
